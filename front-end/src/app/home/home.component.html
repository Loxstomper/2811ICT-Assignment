
<!-- Nav Bar -->
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
  <!-- Branding on left side-->
  <a class="navbar-brand" routerLink="#">SomeChat.io</a>
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <!-- Main Nav panel -->
  <div class="collapse navbar-collapse" id="navbarColor01">
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" routerLink="#">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" (click)="logout()" routerLink="login">Sign Out</a>
      </li>
    </ul>
    
    <!-- Welcome note on right side -->
    <ul class="navbar-nav">
      <li class="nav-item">
        <p> Welcome <strong> {{ username }}</strong> </p>
        
      </li>
    </ul>
  </div>
</nav>

<!-- Main Body -->
<div class="container h-100" style="max-width: 1920px; padding: 0px; margin-left: auto; margin-right: auto">
  <div class="row" style="width: 100%">
      <!-- Groups -->
      <div class="col-lg-2" style="padding:0px">

        <!-- Groups Section -->
        <div class="card mb-3">
          <h3 class="card-header">Groups</h3>
          <div class="card-body" style="height: 500px; overflow-y:hidden">

            <!-- New Group Form -->
            <div class="form-inline" >
              <form (submit)="createGroup($event)">
                <input class="form-control" name="newGroupName" style="width:calc(100% - 100px)" placeholder="New Group" type="text" [(ngModel)]="newGroupName">
                <button class="btn btn-primary" style="width:100px">Create</button>
              </form>
            </div>

            <!-- List of Groups -->
            <div style="height: 500px; overflow-y:auto">
              <div class="row" *ngFor="let group of groups">
                  <button type="button" (click)="openGroup(group)" class="btn btn-outline-success col-lg-12">{{ group }}</button>
                  <button type="button" class="btn btn-danger col-lg-2" (click)="deleteGroup(group)" *ngIf="user_obj.superadmin">-</button>
              </div>
            </div>
          </div>
        </div>        
      </div>

      <!-- Channels Column -->
      <div class="col-lg-2" style="padding:0px">
        <div class="card mb-3">
          <h3 class="card-header">Channels</h3>
          <div class="card-body" style="height: 500px; overflow-y:hidden">

            <!-- New Channel Form -->
            <div *ngIf="user_obj.superadmin || user_obj.group_admin" class="form-inline" >
              <form (submit)="create_channel($event)">
              <input class="form-control" name="newGroupName" style="width:calc(100% - 100px)" placeholder="New Channel" type="text" [(ngModel)]="new_channel_name">
              <button class="btn btn-primary" style="width:100px">Create</button>
              </form>
            </div>

            <!-- List of Channels -->
            <div style="height: 500px; overflow-y:auto">
              <app-channels [channels]=channels [group]=selectedGroup (channelChanged)="channelChangedHandler($event)"></app-channels>
            </div>
          </div>
        </div> 
      </div>


      <!-- Chat Column -->
      <div class="col-lg-6" style="padding:0px">
        <app-chat [channel]=selectedChannel></app-chat>
      </div>

      <!-- Members Column -->
      <div class="col-lg-2" style="padding:0px; background-color: rgba(238, 232, 213, 0.125); height: 560px">
        <h3 style="text-align:center; width:100%; height: 60px; border-bottom: 1px solid rgba(0, 43, 54, 0, 0.95); background-color: rgba(23, 62, 71, 1);">Users</h3>
        <div style="height: 490px; overflow-y: auto">
          <ng-container *ngIf="selectedChannel != null" >
              <p *ngFor="let member of selectedChannel.users">
                <img src="http://localhost:3000/api/images/users/default.png" height="50px" width="50px" style="margin-left: 10px; border-radius: 50%;"> {{ member }} 
              </p>
          </ng-container>
        </div>
      </div>
    </div>
</div>


<h3> SUPERADMIN: {{ user_obj.superadmin }} </h3>
<h3> GROUP ADMIN: {{ user_obj.group_admin }} </h3>

<br><br>
<!-- uploading image -->
<h3> Upload profile picture </h3>
<form>
  <div class="form-group">
    <input type="file" class="form-control" (change)="on_file_selected($event)" name="uploadfile">
    <button class="btn btn-primary" type="button" (click)="upload_file()"> Upload </button>
  </div>
</form> 


<br><br>

<!-- my creating user  -->

<div *ngIf="user_obj.superadmin || user_obj.group_admin">
  <h3> Create User </h3>
    <form (submit)="create_user($event)">
    <!-- <input class="form-control" name="newGroupName" style="width:calc(100% - 100px)" placeholder="username" type="text" [(ngModel)]="newGroupName"> -->
    <input class="form-control" name="create_username"   placeholder="username" type="text" [(ngModel)]="new_user.username" required>
    <input class="form-control" name="create_email"      placeholder="someone@example.com" type="email" [(ngModel)]="new_user.email" required>
    <input class="form-control" name="create_password"   placeholder="password" type="password" [(ngModel)]="new_user.password" required>
    <label *ngIf="user_obj.superadmin">superadmin:
    <input class="form-control" name="create_superadmin" value="testing" type="checkbox" [(ngModel)]="new_user.superadmin">
    </label>
    <label>group admin:
    <input class="form-control" name="create_superadmin" value="testing" type="checkbox" [(ngModel)]="new_user.superadmin">
    </label>
    <br><br>
    <button class="btn btn-primary" style="width:100px">Create</button>
    </form>
</div>

<br><br>

<div *ngIf="user_obj.superadmin">
  <h3> Delete User </h3>
    <form (submit)="delete_user($event)">

      <!-- <select ng-model="user_to_delete" ng-options="user for user in all_users">
      </select> -->
      <select name="user_to_delete" [(ngModel)]="user_to_delete">
        <option *ngFor="let user of all_users" value="{{ user }}"> {{ user }} </option>
      </select>

    <br><br>
    <button class="btn btn-danger" style="width:100px">Delete</button>
    </form>
</div>